---
layout: post
title: "Go TIL"
date: 2022-09-13 14:17:00 +0900
categories: [Language,Go]
---

## 2022-09-13
- `new(T)` vs `Make(T)`
    - `new(T)` allocates zeroed storage for a new item of type T and returns its address as a value of type *T
    - `make(T)` returns an initialized value of type T.
    - For slices, maps and channels: use `make`
    - For arrays, structs and all value types: use  `new`
- Go Best practices
    - value type에 대한 pointer를 misuse하지 말기, 이는 stack에 있는 값을 heap영역으로 복사하게 되면서 추가적으로 메모리 할당이 일어나게 된다.

## 2022-09-16
- 코드 리뷰중 배운사항
    - 새로운 파일을 git에 추가시, 파일의 맨마지막에 newline을 반드시 추가하는것이 컨벤션이다. 이렇게 해야하는 이유는 다음에 파일을 수정할때 newline을 입력하면서 diff에 newline입력부분이 포함되어 지저분해지기 때문이다. GoLand에서는 파일 저장시 자동으로 newline을 삽입하도록 설정할수 있다.(2022.2 버전기준으로 Preferences -> Editor -> General -> OnSave 하단에 Ensure every file ends with a line break)
    - 윈도우에서는 newline문자를 crlf를 사용하고 unix/linux에서는 lf를 사용한다. 만약 윈도우에서 작업한 파일을 클론하여 수정하면 crlf 문자를 lf로 변환하는 불필요한 diff가 발생하게 된다. 이를 해결하기 위해서 `core.autocrlf` 설정을 세팅해야 한다. 아래와 같은 옵션이 있는데 mac의 경우 input으로 설정하고 windows의 경우 true로 설정해야 한다.
        - core.autocrlf = false. 기본 설정이다. 파일에 CRLF 를 썼든 LF 를 썼든 git 은 상관하지 않고 파일 그대로 checkin, checkout 한다. 이 설정은 line ending 이 다른 OS 에서는 text file 이 변경되었다고 나오므로 위에서 언급한 여러 가지 문제가 발생할 수 있다.
        - core.autocrlf = true text file을 object database 에 넣기전에 CRLF 를 LF 로 변경한다.
        - core.autocrlf = input LF를 line ending 으로 사용한다.
    - git commit 메시지 작성요령 : `https://meetup.toast.com/posts/106`
        - 여기서 명령형으로 하는 이유가 git에서 자동생성된 커밋과 위화감 없게 하기위함 이라니 신기했다.
        - 커밋 메시지의 첫문자는 항상 대문자, 명령형으로 시작하기!
- 동료의 개발환경 세팅을 도와주던중 `protoc output: protoc error: fork/exec /usr/local/bin/protoc: exec format error` 라는 에러를 보게되었는데 이것을 보고 protoc 실행에 문제가 있다고 의심을 했어야 했다. 그런데 m1 mac이라서 protoc가 제대로 동작하지 않을거라고 망상했다. 소경이 소경을 인도할수는 없다. 항상 글자 그대로 받아들이는 연습을 해야겠다.

