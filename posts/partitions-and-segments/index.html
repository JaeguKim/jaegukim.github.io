<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Segment and Log Compaction Policy" /><meta name="author" content="Jaegoo Kim" /><meta property="og:locale" content="en" /><meta name="description" content="Segment" /><meta property="og:description" content="Segment" /><link rel="canonical" href="https://jaegukim.github.io/posts/partitions-and-segments/" /><meta property="og:url" content="https://jaegukim.github.io/posts/partitions-and-segments/" /><meta property="og:site_name" content="Study Log" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2020-12-03T18:01:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Segment and Log Compaction Policy" /><meta name="twitter:site" content="@JaeguKim" /><meta name="twitter:creator" content="@Jaegoo Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jaegoo Kim"},"dateModified":"2021-03-25T10:42:58+08:00","datePublished":"2020-12-03T18:01:00+08:00","description":"Segment","headline":"Segment and Log Compaction Policy","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaegukim.github.io/posts/partitions-and-segments/"},"url":"https://jaegukim.github.io/posts/partitions-and-segments/"}</script><title>Segment and Log Compaction Policy | Study Log</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Study Log"><meta name="application-name" content="Study Log"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/22807942?s=460&u=cc1d822a8be2c87ac3aa4917adaadeca5487c515&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Study Log</a></div><div class="site-subtitle font-italic">“ In order to be irreplaceable, one must always be different” – Coco Chanel</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/JaeguKim" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/JaeguKim" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kimwithglasses','kakao.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Segment and Log Compaction Policy</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Segment and Log Compaction Policy</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Jaegoo.Kim </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Dec 3, 2020, 6:01 PM +0800" >Dec 3, 2020<i class="unloaded">2020-12-03T18:01:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Thu, Mar 25, 2021, 11:42 AM +0900" >Mar 25, 2021<i class="unloaded">2021-03-25T10:42:58+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="724 words">4 min read</span></div></div><div class="post-content"><h2 id="segment">Segment</h2><ul><li><p>토픽들은 파티션으로 구성되 있음</p><li><p>파티션들은 segment로 이루어져 있음</p><li><p>오직 기록되고 있는 segment만 활성화 되어있음</p><li><p>세그먼트는 두개의 index(파일)로 구성됨</p><ul><li><p>offset : kafka가 읽어야하는 위치를 찾기위한 인덱스</p><li><p>timestamp : timestamp를 가진 메시지들을 찾기 위한 인덱스</p><li><p>카프카는 constant time에 데이터를 찾음.</p></ul></ul><h2 id="segment-setting">Segment Setting</h2><ul><li><p><code class="language-plaintext highlighter-rouge">log.segment.bytes</code> : single segment의 최대 byte 사이즈(default 1GB)</p><ul><li><p>값이 작아지면 그만큼 partition당 segment수가 많아진다.</p><li><p>log compaction이 더 자주 일어난다.</p><li><p>더 많은 파일들을 열고 있어야하므로 error 발생</p></ul><li><p><code class="language-plaintext highlighter-rouge">log.segment.ms</code> : segment를 commit할때 까지 기다리는 시간(segment가 가득 차지 않았을때)</p><ul><li><p>default 1 week</p><li><p>값이 작아지면 log compaction이 더 자주 일어난다.</p></ul></ul><h2 id="log-cleanup-policies">Log Cleanup Policies</h2><ul><li><p>많은 Kafka 클러스터들이 데이터를 policy에 따라서 폐기함</p><li><p>이 개념을 log cleanup 이라고 부름</p><li><p>디스크에 있는 데이터 사이즈 조절, 필요없는 데이터 삭제</p><li><p>log cleanup은 partition segment에서 일어난다.</p><li><p>크키가 작은 segment들이 많으면 log cleanup이 더 자주 발생한다. (더 많은 CPU, RAM 자원을 소모한다.)</p><li><p>Policy1 : <code class="language-plaintext highlighter-rouge">log.cleanup.policy=delete</code> (모든 유저 토픽에 대해서 default)</p><ul><li><p>data의 age에 따라서 삭제(default 1 week)</p><li><p>log의 최대 크기에 따라서 삭제(default -1 == infinite)</p></ul><li><p>Policy2 : <code class="language-plaintext highlighter-rouge">log.cleanup.policy=compact</code> (__consumer_offsets 토픽에 대한 default)</p><ul><li><p>메시지의 key에 기반하여 삭제</p><li><p>active segment 커밋후 중복된 키들을 삭제</p><li><p>Segment.ms (default 7 days) : active segment 닫기 까지 기다리는 최대시간</p><li><p>Segment.bytes (default 1G) : segement의 최대사이즈</p><li><p>Min.compaction.lag.ms (default 0) : message가 compact 되기까지 기다리는 시간</p><li><p>Delete.retention.ms (default 24 hours) : compaction으로 데이터가 완전히 삭제되기 전에 삭제된 데이터를 볼수 있는 시간</p><li><p>Min.Cleanable.dirty.ratio (default 0.5) : 값이 높을수록 compaction 양이 줄어듬, 더 efficient cleaning, 값이 작을수록 compaction 양은 많아짐, 느린 cleaning</p></ul><li><p>Policy3 : <code class="language-plaintext highlighter-rouge">log.retention.hours</code></p><ul><li><p>data를 보관하는 시간(default 168시간 - 1주)</p><li><p>길수록 디스크 용량을 많이 차지함</p><li><p>짧을수록 데이터 보관량이 줄어듬</p></ul><li><p>Policy4 : <code class="language-plaintext highlighter-rouge">log.retention.bytes</code></p><ul><li>각각의 파티션이 가질수있는 최대 용량(bytes), default -1 - infinite</ul><li><p>자주 사용되는 조합</p><ul><li><p>One week of retention : <code class="language-plaintext highlighter-rouge">log.retention.hours=168</code>, <code class="language-plaintext highlighter-rouge">log.retention.bytes</code> = -1</p><li><p><code class="language-plaintext highlighter-rouge">log.retentions.hours=17520, log.retention.bytes = 524288000</code></p></ul><li><p>Policy5 : <code class="language-plaintext highlighter-rouge">unclean.leader.election</code></p><ul><li><p>In Sync Replicas(ISR) 이 죽을경우 다음 옵션이 존재함.</p><ul><li><p>unclean.leader.election = false : ISR이 online 될때까지 대기 (default)</p><li><p>unclean.leader.election = true : non ISR partitions에 데이터를 producing</p></ul><li><p>unclean.leader.election = true 일경우 availability는 증가하지만, ISR로 가야하는 데이터는 사라짐</p><li><p>매우 위험한 세팅이므로, 주의해서 세팅해야함.</p><li><p>Use case : metrics collection, log collection, data loss가 acceptable한 경우</p></ul></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dataengineering/'>DataEngineering</a>, <a href='/categories/kafka/'>Kafka</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Segment and Log Compaction Policy - Study Log&url=https://jaegukim.github.io/posts/partitions-and-segments/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Segment and Log Compaction Policy - Study Log&u=https://jaegukim.github.io/posts/partitions-and-segments/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Segment and Log Compaction Policy - Study Log&url=https://jaegukim.github.io/posts/partitions-and-segments/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/software-engineering-at-google/">Software Engineering at Google</a><li><a href="/posts/til/">TIL</a><li><a href="/posts/custom-default-backend-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0/">custom error page 띄우기</a><li><a href="/posts/cors-setting/">CORS setting</a><li><a href="/posts/helm-chart/">Helm Chart</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/kafka-transaction/"><div class="card-body"> <span class="timeago small" >Dec 19, 2021<i class="unloaded">2021-12-19T13:19:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kafka Transaction</h3><div class="text-muted small"><p> Kafka Transaction 카프카에서 exactly once delievery를 지원하기 위해서 0.11.0.0 이후 버전 이후부터 카프카 트랜잭션 기능을 지원한다. exactly once delievery가 적용되는 범위는 프로듀서부터 컨슈머 까지 연결되는 파이프라인이다. 하지만 컨슈머에서 여전히 중복 데이터 처리가 발생할 수 있다. Use...</p></div></div></a></div><div class="card"> <a href="/posts/local-kafka-setup/"><div class="card-body"> <span class="timeago small" >Dec 19, 2021<i class="unloaded">2021-12-19T13:45:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Local Kafka Setup</h3><div class="text-muted small"><p> link https://blog.voidmainvoid.net/411</p></div></div></a></div><div class="card"> <a href="/posts/kafka-rebalancing/"><div class="card-body"> <span class="timeago small" >Jan 5, 2022<i class="unloaded">2022-01-05T21:41:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kafka Rebalancing</h3><div class="text-muted small"><p> 참고</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/travis-ci%EC%97%90%EC%84%9C-spring-boot-app-%ED%85%8C%EC%8A%A4%ED%8A%B8%ED%95%98%EA%B8%B0/" class="btn btn-outline-primary" prompt="Older"><p>Travis CI에서 Spring boot app 테스트하기</p></a> <a href="/posts/trouble-shooting-could-not-find-gem-'nokogumbo~-2.0'-%ED%95%B4%EA%B2%B0%ED%95%98%EA%B8%B0/" class="btn btn-outline-primary" prompt="Newer"><p>[Trouble Shooting] Could not find gem 'nokogumbo(~> 2.0)' 해결하기</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//jaegukim.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Segment and Log Compaction Policy'; this.page.url = 'https://jaegukim.github.io/posts/partitions-and-segments/'; this.page.identifier = '/posts/partitions-and-segments/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Jaegoo.Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jaegukim.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
