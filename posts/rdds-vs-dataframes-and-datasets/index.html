<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="RDDs vs DataFrames vs Datasets" /><meta name="author" content="Jaegoo Kim" /><meta property="og:locale" content="en" /><meta name="description" content="Resilient Distributed Dataset(RDD)" /><meta property="og:description" content="Resilient Distributed Dataset(RDD)" /><link rel="canonical" href="https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/" /><meta property="og:url" content="https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/" /><meta property="og:site_name" content="Study Log" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-02T17:39:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="RDDs vs DataFrames vs Datasets" /><meta name="twitter:site" content="@JaeguKim" /><meta name="twitter:creator" content="@Jaegoo Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jaegoo Kim"},"dateModified":"2021-06-14T20:01:34+08:00","datePublished":"2021-02-02T17:39:00+08:00","description":"Resilient Distributed Dataset(RDD)","headline":"RDDs vs DataFrames vs Datasets","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/"},"url":"https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/"}</script><title>RDDs vs DataFrames vs Datasets | Study Log</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Study Log"><meta name="application-name" content="Study Log"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/22807942?s=460&u=cc1d822a8be2c87ac3aa4917adaadeca5487c515&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Study Log</a></div><div class="site-subtitle font-italic">“ In order to be irreplaceable, one must always be different” – Coco Chanel</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/JaeguKim" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/JaeguKim" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kimwithglasses','kakao.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>RDDs vs DataFrames vs Datasets</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>RDDs vs DataFrames vs Datasets</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Jaegoo.Kim </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 2, 2021, 5:39 PM +0800" >Feb 2, 2021<i class="unloaded">2021-02-02T17:39:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Jun 14, 2021, 9:01 PM +0900" >Jun 14, 2021<i class="unloaded">2021-06-14T20:01:34+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1169 words">6 min read</span></div></div><div class="post-content"><h2 id="resilient-distributed-datasetrdd">Resilient Distributed Dataset(RDD)</h2><p>RDD는 데이터의 immutable distributed collection, 클러스터의 노드들에 분할되어있고 병렬적으로 처리됨. 여러 분산 노드에 걸쳐서 저장되는 변경이 불가능한 데이터(객체)의 집합으로 각각의 RDD는 여러개의 파티션으로 분리가 됩니다. 즉, 스파크 내에 저장된 데이터를 RDD라고 하고, 변경이 불가능하며, 변경을 하려면 새로운 데이터 셋을 생성해야 합니다.</p><h3 id="언제-rdd를-사용하는가">언제 RDD를 사용하는가?</h3><ul><li>dataset에 대해서, low-level transformation, action, control이 필요할때<li>media stream, text stream과 같이 데이터가 unstructured 구조일때<li>functional programming으로 데이터를 다루고 싶을때<li>columnar format과 같은 스키마를 써도 상관없는 경우</ul><h2 id="dataframe">DataFrame</h2><ul><li>rdb 테이블처럼, 데이터가 named column으로 정리되어있음<li>RDD처럼 immutable distributed collection of data</ul><p><img data-proofer-ignore data-src="https://databricks.com/wp-content/uploads/2016/06/Unified-Apache-Spark-2.0-API-1.png" alt="img" /></p><h2 id="dataset">Dataset</h2><p>Spark 2.0부터 Dataset은 두가지 다른 성질의 API를 제공한다: <strong>strongly-typed</strong> API, <strong>untyped API</strong></p><p>개념적으로 DataFrame은 generic Dataset[Row] 객체 컬렉션의 별칭으로 볼수 있다. ROW는 <strong>untyped</strong> JVM 객체이다. Dataset은 대조적으로, <strong>strongly-typed</strong> JVM 객체 컬렉션으로 볼수 있다.</p><h3 id="typed-and-un-typed-apis">Typed and Un-typed APIs</h3><div class="table-wrapper"><table><thead><tr><th>Language<th>Main Abstraction<tbody><tr><td>Scala<td>Dataset[T] &amp; DataFrame(alias for Dataset[Row])<tr><td>Java<td>Dataset[T]<tr><td>Python<td>DataFrame<tr><td>R<td>DataFrame</table></div><h2 id="dataset-api의-장점">Dataset API의 장점</h2><h3 id="1-static-typing-runtime-type-safety">1. Static-typing, runtime type-safety</h3><p>SparkSQL의 경우 runtime 전까지 문법오류를 알수 없다. 반면에 DataFrame이나 Dataset를 사용할경우 compile 시간안에 에러를 알수 있다.(시간이 절약된다.) 즉 DataFrame api의 일부가 아닌 함수를 호출하면, 컴파일러가 오류를 감지한다. 하지만 존재하지 않는 컬럼네임을 감지하는것은 런타임 전까지는 알수 없다.</p><p><img data-proofer-ignore data-src="https://databricks.com/wp-content/uploads/2016/07/sql-vs-dataframes-vs-datasets-type-safety-spectrum.png" alt="img" /></p><h3 id="2-structured-and-semi-structured-data에게-high-level-abstraction과-custom-view-제공">2. Structured and semi-structured data에게 High-level abstraction과 custom view 제공</h3><p>DataFrame은 semi-structured data에게 structed custom view를 제공할수 있다. 예를들어, 대용량 IoT device event dataset이 있다고 가정하고, 포맷이 JSON으로 되어있다고 하자. JSON은 semi-structued format이기 때문에 Dataset[DeviceIoTData] 라는 강한 정적타입으로 변환 될수 있다.</p><div lang="json" class="language-json highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"device_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">198164</span><span class="p">,</span><span class="w"> </span><span class="nl">"device_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sensor-pad-198164owomcJZ"</span><span class="p">,</span><span class="w"> </span><span class="nl">"ip"</span><span class="p">:</span><span class="w"> </span><span class="s2">"80.55.20.25"</span><span class="p">,</span><span class="w"> </span><span class="nl">"cca2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"PL"</span><span class="p">,</span><span class="w"> </span><span class="nl">"cca3"</span><span class="p">:</span><span class="w"> </span><span class="s2">"POL"</span><span class="p">,</span><span class="w"> </span><span class="nl">"cn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Poland"</span><span class="p">,</span><span class="w"> </span><span class="nl">"latitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">53.080000</span><span class="p">,</span><span class="w"> </span><span class="nl">"longitude"</span><span class="p">:</span><span class="w"> </span><span class="mf">18.620000</span><span class="p">,</span><span class="w"> </span><span class="nl">"scale"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Celsius"</span><span class="p">,</span><span class="w"> </span><span class="nl">"temp"</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="p">,</span><span class="w"> </span><span class="nl">"humidity"</span><span class="p">:</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="nl">"battery_level"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="nl">"c02_level"</span><span class="p">:</span><span class="w"> </span><span class="mi">1408</span><span class="p">,</span><span class="w"> </span><span class="nl">"lcd"</span><span class="p">:</span><span class="w"> </span><span class="s2">"red"</span><span class="p">,</span><span class="w"> </span><span class="nl">"timestamp"</span><span class="w"> </span><span class="p">:</span><span class="mi">1458081226051</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">case</span> <span class="k">class</span> <span class="nc">DeviceIoTData</span> <span class="o">(</span><span class="n">battery_level</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">c02_level</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">cca2</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">cca3</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">cn</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">device_id</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">device_name</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">humidity</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">ip</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">latitude</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">lcd</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">longitude</span><span class="k">:</span> <span class="kt">Double</span><span class="o">,</span> <span class="n">scale</span><span class="k">:</span><span class="kt">String</span><span class="o">,</span> <span class="n">temp</span><span class="k">:</span> <span class="kt">Long</span><span class="o">,</span> <span class="n">timestamp</span><span class="k">:</span> <span class="kt">Long</span><span class="o">)</span>

</pre></table></code></div></div><p>그리고 JSON 파일을 다음처럼 읽을수 있다.</p><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="c1">// read the json file and create the dataset from the </span>
<span class="c1">// case class DeviceIoTData</span>
<span class="c1">// ds is now a collection of JVM Scala objects DeviceIoTData</span>
<span class="k">val</span> <span class="nv">ds</span> <span class="k">=</span> <span class="nv">spark</span><span class="o">.</span><span class="py">read</span><span class="o">.</span><span class="py">json</span><span class="o">(</span><span class="err">“</span><span class="o">/</span><span class="n">databricks</span><span class="o">-</span><span class="n">public</span><span class="o">-</span><span class="n">datasets</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">iot</span><span class="o">/</span><span class="nv">iot_devices</span><span class="o">.</span><span class="py">json</span><span class="err">”</span><span class="o">).</span><span class="py">as</span><span class="o">[</span><span class="kt">DeviceIoTData</span><span class="o">]</span>
</pre></table></code></div></div><p>내부적으로 다음과 같은 일이 일어난다.</p><ol><li>Spark가 JSON을 읽고, schema를 추론한다 그리고 DataFrame 컬렉션을 생성한다.<li>이 시점에, Spark은 정확한 타입을 모르기 때문에 데이터를 DataFrame=Dataset[Row]으로 변환한다.<li>그리고 Spark은 Dataset[Row] -&gt; Dataset[DeviceIoTData] (type-specific Scala JVM object)로 변환한다.</ol><p>결과적으로 다음과 같이 시각화 할수 있다.</p><p><img data-proofer-ignore data-src="https://databricks.com/wp-content/uploads/2016/07/displaying-a-dataset.png" alt="img" /></p><h3 id="3-ease-of-use-of-apis">3. Ease-of-use of APIs</h3><p>Dataset의 high level api를 이용하면, <code class="language-plaintext highlighter-rouge">agg</code>, <code class="language-plaintext highlighter-rouge">select</code>, <code class="language-plaintext highlighter-rouge">sum</code> 등 다양한 연산을 할수 있고 RDD row의 데이터 필드를 사용하는것보다 훨씬 간단하다.</p><h3 id="4-performance-and-optimization">4. Performance and Optimization</h3><p>DataFrame과 Dataset API는 RDD에 비해서 공간 효율적이고 퍼포먼스가 좋은데 이유는 두가지이다.</p><p>DataFrame과 Dataset API는 Spark SQL engine을 기반으로 만들어졌기 때문에, 논리적.물리적 쿼리 플랜을 생성하기 위해서 Catalyst를 사용한다. R.Java.Scala.Python 모두 쿼리들은 같은 코드 optimizer를 실행하고, 시간.공간 효율적인 코드로 최적화된다. Dataset[T] 타입 API는 데이터 엔지니어링 테스크에 최적화되어있고, untyped Dataset[Row] 즉, DataFrame은 interactive analysis에 최적화되어있다.</p><p><img data-proofer-ignore data-src="https://databricks.com/wp-content/uploads/2016/07/memory-usage-when-caching-datasets-vs-rdds.png" alt="img" /></p><p>두번째 이유는 <a href="https://databricks.com/blog/2016/05/23/apache-spark-as-a-compiler-joining-a-billion-rows-per-second-on-a-laptop.html">Spark as a compiler</a> 가 Dataset type JVM 객체를 이해하기 때문에, <a href="https://databricks.com/blog/2015/04/28/project-tungsten-bringing-spark-closer-to-bare-metal.html">Encoders</a> 를 사용해서 type specific JVM object를 Tungsten’s internal memory representation으로 맵핑한다. 결과적으로 <a href="https://databricks.com/glossary/tungsten">Tungsten</a>Encoder는 효율적으로 JVM 객체를 직열화/역직열화 할수 있을 뿐만아니라 빠른속도로 실행될수 있는 compact byte code를 생성한다.</p><h3 id="dataframe-dataset을-써야하는-경우">DataFrame, DataSet을 써야하는 경우</h3><ul><li>Rich semantics, high-level abstraction, domain specific API를 원할경우<li>filters,maps,aggregation,averge,sum,sql query, columnar access, semi-structured data에 대해서 lambda function을 사용할경우<li>컴파일시간에 type-safety, typed JVM object, Catalyst optimization, Tungsten’s efficient code generation을 이용하고 싶은 경우</ul><h2 id="출처">출처</h2><p><a href="https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html">https://databricks.com/blog/2016/07/14/a-tale-of-three-apache-spark-apis-rdds-dataframes-and-datasets.html</a></p><p><a href="https://bcho.tistory.com/1027">https://bcho.tistory.com/1027</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dataengineering/'>DataEngineering</a>, <a href='/categories/spark/'>Spark</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=RDDs vs DataFrames vs Datasets - Study Log&url=https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=RDDs vs DataFrames vs Datasets - Study Log&u=https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=RDDs vs DataFrames vs Datasets - Study Log&url=https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/software-engineering-at-google/">Software Engineering at Google</a><li><a href="/posts/til/">TIL</a><li><a href="/posts/custom-default-backend-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0/">custom error page 띄우기</a><li><a href="/posts/cors-setting/">CORS setting</a><li><a href="/posts/helm-chart/">Helm Chart</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spark/"><div class="card-body"> <span class="timeago small" >Sep 24, 2020<i class="unloaded">2020-09-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spark와 Data Engineering 관련 프로젝트 시작하기</h3><div class="text-muted small"><p> What Is Spark? Open-source distributed general-purpose cluster-computing framework. How to start data engineering projects? Choose any framework, let’s say Kafka. Write some codes using that ...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%A4%91%EC%B2%A9%EB%90%9C-schema-flattening%ED%95%98%EA%B8%B0/"><div class="card-body"> <span class="timeago small" >Feb 10, 2021<i class="unloaded">2021-02-10T08:56:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>중첩된 schema flattening하기</h3><div class="text-muted small"><p> 1 2 3 4 5 6 7 8 9 def flattenSchema(schema: StructType, prefix: String = null): Array[Column] = { schema.fields.flatMap(f =&gt; { val colName = if (prefix == null) f.name else (prefix + "...</p></div></div></a></div><div class="card"> <a href="/posts/trouble-shooting-cannot-resolve-columnnumeric-column-name-in-spark-dataframe/"><div class="card-body"> <span class="timeago small" >Feb 10, 2021<i class="unloaded">2021-02-10T08:59:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[Trouble Shooting] cannot resolve column(numeric column name) in Spark Dataframe</h3><div class="text-muted small"><p> 다음과 같은 스키마가 있다고 하자. 1 2 3 4 5 scala&gt; data.printSchema root |-- 1.0: string (nullable = true) |-- 2.0: string (nullable = true) |-- 3.0: string (nullable = true) 이 경우 다음 라인을 실행하면 에러가 난다. 1...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/hdfs-connector-2/" class="btn btn-outline-primary" prompt="Older"><p>HDFS Connector 2</p></a> <a href="/posts/avro-vs-parquet/" class="btn btn-outline-primary" prompt="Newer"><p>Avro vs Parquet</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//jaegukim.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'RDDs vs DataFrames vs Datasets'; this.page.url = 'https://jaegukim.github.io/posts/rdds-vs-dataframes-and-datasets/'; this.page.identifier = '/posts/rdds-vs-dataframes-and-datasets/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Jaegoo.Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jaegukim.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
