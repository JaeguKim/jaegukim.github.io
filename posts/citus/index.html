<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Citus" /><meta name="author" content="Jaegoo Kim" /><meta property="og:locale" content="en" /><meta name="description" content="Citus란?" /><meta property="og:description" content="Citus란?" /><link rel="canonical" href="https://jaegukim.github.io/posts/citus/" /><meta property="og:url" content="https://jaegukim.github.io/posts/citus/" /><meta property="og:site_name" content="Study Log" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-03-09T12:35:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Citus" /><meta name="twitter:site" content="@JaeguKim" /><meta name="twitter:creator" content="@Jaegoo Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jaegoo Kim"},"dateModified":"2021-03-28T20:44:39+08:00","datePublished":"2021-03-09T12:35:00+08:00","description":"Citus란?","headline":"Citus","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaegukim.github.io/posts/citus/"},"url":"https://jaegukim.github.io/posts/citus/"}</script><title>Citus | Study Log</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Study Log"><meta name="application-name" content="Study Log"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/22807942?s=460&u=cc1d822a8be2c87ac3aa4917adaadeca5487c515&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Study Log</a></div><div class="site-subtitle font-italic">“ In order to be irreplaceable, one must always be different” – Coco Chanel</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/JaeguKim" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/JaeguKim" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kimwithglasses','kakao.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Citus</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Citus</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Jaegoo.Kim </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Mar 9, 2021, 12:35 PM +0800" >Mar 9, 2021<i class="unloaded">2021-03-09T12:35:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Mar 28, 2021, 9:44 PM +0900" >Mar 28, 2021<i class="unloaded">2021-03-28T20:44:39+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2102 words">11 min read</span></div></div><div class="post-content"><h2 id="citus란">Citus란?</h2><p>여러 머신에 쿼리하고 데이터를 분산할수 있도록 하는 PostgreSQL의 extension. sharding과 replication을 사용해서 수평확장한다.</p><h2 id="언제-사용하는가">언제 사용하는가?</h2><h3 id="1-multi-tenant-database">1. Multi-Tenant Database</h3><ul><li>모든 tenant에 빠른 쿼리가능<li>database에 sharding logic이 있음<li>단일 노드 PostgreSQL보다 더 많은 데이터 소유가능<li>SQL을 포기하는것 없이 Scale out<li>high concurrency를 보장하고 동시에 퍼포먼스도 유지<li>빠른 metric 분석가능<li>신규 사용자를 다루기위해 쉽게 scale out 가능</ul><h3 id="2-real-time-analytics다">2. Real-Time Analytics다.</h3><ul><li>데이터가 많아 지더라도 1초내에 응답가능<li>실시간으로 새로운 이벤트,데이터를 분석가능<li>SQL 쿼리를 병렬적으로 실행가능<li>dashboard query에 대해 빠른 응답가능</ul><h2 id="사용이-적절하지-않은경우">사용이 적절하지 않은경우</h2><ul><li>단일 노드 Postgres로 커버가 되는경우<li>real-time ingest, real-time query가 필요없는 offline analytics의 경우<li>많은 사용자들에게 병렬적으로 기능을 제공할 필요가 없는경우<li>요약된 결과가 아닌, 무거운 ETL 결과를 리턴하는 쿼리의 경우</ul><h2 id="concepts">Concepts</h2><h3 id="1-nodes">1. Nodes</h3><h3 id="coordinator-and-workers">Coordinator and Workers</h3><p>모든 클러스터는 <code class="language-plaintext highlighter-rouge">coordinator</code> 라는 특별한 노드가 있는데, 다른 노드들은 worker라고 부른다. 어플리케이션이 coordinator 노드에게 쿼리를 보내면, coordinator는 관련있는 worker에게 이를 전파하고 결과를 받아온다.</p><p>각각의 쿼리에 대해서, <code class="language-plaintext highlighter-rouge">coordinator</code>는 단일 worker로 요청으로 보내거나 요구되는 데이터가 여러 노드에 존재할경우에는 병렬적으로 여러 worker에게 요청을 보낸다. <code class="language-plaintext highlighter-rouge">coordinator</code>는 메타데이터 테이블와 소통하면서 이 과정을 어떻게 할지 알아낸다. Citus-specific table들은 DNS 이름들과 워커노드들의 health를 모니터링하고 노드들에 있는 데이터의 분포 또한 모니터링한다. 더 궁금하다면 다음 <a href="http://docs.citusdata.com/en/v9.5/develop/api_metadata.html#metadata-tables">Citus Tables and Views</a>를 참고하자.</p><h2 id="2-distributed-data">2. Distributed Data</h2><h3 id="table-types">Table Types</h3><p>Citus cluster에는 세가지 타입의 테이블들이 존재한다.</p><h4 id="type1--distributed-tables">Type1 : Distributed Tables</h4><p>첫번째 타입은 distributed table이다. SQL statement에 대한 보통 테이블처럼 보이지만 worker node에 수평적으로 partition되어있다.</p><p><img data-proofer-ignore data-src="http://docs.citusdata.com/en/v9.5/_images/diagram-parallel-select.png" alt="img" /></p><p>component worker table들을 shard라고 부른다. Citus는 SQL을 실행할뿐 아니라 DDL 문까지 실행한다. 따라서 분산 테이블의 스키마를 수정하면, 모든 워커들에 있는 모든 테이블의 샤드들에게 업데이트가 적용된다. 분산 테이블을 생성하는과정이 궁금하면 <a href="http://docs.citusdata.com/en/v9.5/develop/reference_ddl.html#ddl">Creating and Modifying Distributed Tables (DDL)</a>를 참고하자.</p><h4 id="distribution-column">Distribution Column</h4><p>Citus는 샤드들에게 행을 할당하기 위해서 algorithmic sharding을 사용한다. 이는 <code class="language-plaintext highlighter-rouge">distribution column</code>이라 불리는 테이블 칼럼에 기반을 두어 행을 할당하는것을 의미한다. 클러스터 관리자는 테이블을 분산할때 이 칼럼을 만드시 지정해야한다. 올바른 결정은 퍼포먼스나 기능수행을 위해서 중요하다. 더 궁금하면 <a href="http://docs.citusdata.com/en/v9.5/sharding/data_modeling.html#distributed-data-modeling">Distributed Data Modeling</a>를 참고하자.</p><h3 id="type-2--reference-tables">Type 2 : Reference Tables</h3><p>reference table은 컨텐츠가 하나의 샤드에 저장되고 모든 워커에 복제가 되어있는 테이블을 말한다. 각각의 워커에 대한 쿼리는 다른 노드에게 행을 요청할 네트워커 오버헤드 없이 로컬에 있는 정보를 접근할수 있다. Reference table은 행마다 독립적인 샤드들을 구분할 필요가 없기 때문에 distribution column이 없다.</p><p>더 궁금하면 <a href="http://docs.citusdata.com/en/v9.5/develop/reference_ddl.html#reference-tables">Reference Tables</a> 를 참고하자.</p><h3 id="type-3--local-tables">Type 3 : Local Tables</h3><p>Citus를 사용할때 coordinator node는 일반 Citus extension이 설치된 PostgreSQL database이다. 따라서 테이블을 생성하고 shard하지 않도록 할수 있다. 이는 작은 관리 테이블의 경우에 유용하다. 예를 들면 application login, authentication을 위한 사용자 테이블이 있다. Citus는 cluster metadata를 저장하기 위해서 local table을 사용한다.</p><h3 id="shards">Shards</h3><p>여기서는 shard를 세부적으로 알아보자.</p><div lang="sql" class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="k">SELECT</span> <span class="o">*</span> <span class="k">from</span> <span class="n">pg_dist_shard</span><span class="p">;</span>
 <span class="n">logicalrelid</span>  <span class="o">|</span> <span class="n">shardid</span> <span class="o">|</span> <span class="n">shardstorage</span> <span class="o">|</span> <span class="n">shardminvalue</span> <span class="o">|</span> <span class="n">shardmaxvalue</span>
<span class="c1">---------------+---------+--------------+---------------+---------------</span>
 <span class="n">github_events</span> <span class="o">|</span>  <span class="mi">102026</span> <span class="o">|</span> <span class="n">t</span>            <span class="o">|</span> <span class="mi">268435456</span>     <span class="o">|</span> <span class="mi">402653183</span>
 <span class="n">github_events</span> <span class="o">|</span>  <span class="mi">102027</span> <span class="o">|</span> <span class="n">t</span>            <span class="o">|</span> <span class="mi">402653184</span>     <span class="o">|</span> <span class="mi">536870911</span>
 <span class="n">github_events</span> <span class="o">|</span>  <span class="mi">102028</span> <span class="o">|</span> <span class="n">t</span>            <span class="o">|</span> <span class="mi">536870912</span>     <span class="o">|</span> <span class="mi">671088639</span>
 <span class="n">github_events</span> <span class="o">|</span>  <span class="mi">102029</span> <span class="o">|</span> <span class="n">t</span>            <span class="o">|</span> <span class="mi">671088640</span>     <span class="o">|</span> <span class="mi">805306367</span>
 <span class="p">(</span><span class="mi">4</span> <span class="k">rows</span><span class="p">)</span>
</pre></table></code></div></div><p>coordinator에 있는 <code class="language-plaintext highlighter-rouge">pg_dist_shard</code> 메타데이터 테이블은 시스템에 있는 각각의 분산 테이블 샤드의 행을 포함한다. row는 hash space내에 있는 정수들의 범위에 대응하는 shardid와 매치된다.</p><p>만약 coordinator 노드가 어느 샤드가 <code class="language-plaintext highlighter-rouge">github_events</code>의 행을 가지고 있는지 결정하려고 하면, row에 있는 distribution column 값을 해쉬하고 어느 샤드의 범위가 hashed value를 포함하는지 검사하면된다.</p><h3 id="shard-placement">Shard Placement</h3><p>샤드 102027에 대해서 질의 한다고 가정해보자. 이는 행이 <code class="language-plaintext highlighter-rouge">github_events_102027</code> 테이블에 대해서 읽혀지거나 쓰여져야하는것을 의미한다. 하지만 워커를 어떻게 알수 있을까? 이는 metadata table에 의해서 결정된다. shard를 worker에 맵핑하는 것을 shard placement라고 부른다.</p><p>metadata table들을 join해서 답을 얻을수 있다. 이러한 유형의 lookup은 coordinator가 쿼리를 route하기 위해서 하는 것이다. coordinator는 쿼리들을 fragment(<code class="language-plaintext highlighter-rouge">github_events_102027</code>과 같은 테이블)에 재작성한다. 그리고 그 fragment들을 적절한 worker에 실행한다.</p><div lang="sql" class="language-sql highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">SELECT</span>
    <span class="n">shardid</span><span class="p">,</span>
    <span class="n">node</span><span class="p">.</span><span class="n">nodename</span><span class="p">,</span>
    <span class="n">node</span><span class="p">.</span><span class="n">nodeport</span>
<span class="k">FROM</span> <span class="n">pg_dist_placement</span> <span class="n">placement</span>
<span class="k">JOIN</span> <span class="n">pg_dist_node</span> <span class="n">node</span>
  <span class="k">ON</span> <span class="n">placement</span><span class="p">.</span><span class="n">groupid</span> <span class="o">=</span> <span class="n">node</span><span class="p">.</span><span class="n">groupid</span>
 <span class="k">AND</span> <span class="n">node</span><span class="p">.</span><span class="n">noderole</span> <span class="o">=</span> <span class="s1">'primary'</span><span class="p">::</span><span class="n">noderole</span>
<span class="k">WHERE</span> <span class="n">shardid</span> <span class="o">=</span> <span class="mi">102027</span><span class="p">;</span>
</pre></table></code></div></div><div lang="plaintext" class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌─────────┬───────────┬──────────┐
│ shardid │ nodename  │ nodeport │
├─────────┼───────────┼──────────┤
│  102027 │ localhost │     5433 │
└─────────┴───────────┴──────────┘
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">github_events</code> 예시에서는 4개의 샤드가 존재한다. 샤드의 수는 테이블마다 설정이 가능하다. Shard count에 대한 내용은 <a href="http://docs.citusdata.com/en/v9.5/admin_guide/cluster_management.html#prod-shard-count">Shard Count</a>를 참고하자.</p><p>Citus는 샤드들의 데이터를 보호하기 위해서 replication을 허용한다. 두가지 replicaton mode가 있는데 Citus replication과 streaming replication이 존재한다. 전자는 shard placement에 대한 추가적인 백업을 생성하고 그것들중 어느하나라도 업데이트 되면 쿼리를 실행한다. 후자는 더 효율적이고 PostgreSQL의 streaming replication을 사용하여 전체 데이터베이스를 follower database에 백업한다. 이는 투명하고 Citus metadata table이 필요없다.</p><h3 id="co-location">Co-Location</h3><p>shard와 replicas가 원하는대로 노드들에 위치될수 있기때문에 관련된 테이블들의 관련된 행들을 포함하는 샤드들을 같은 노드에 위치시키는 것은 당연한일이다. 이러한 방식으로 join query는 네트워크로 추가적인 정보를 보내는것을 피할수 있고, 단일 Citus node내에서 처리될수 있다.</p><p>한가지 예는 store,product,purchase을 가진 데이터베이스이다. 만약 세가지 테이블들이 store_id 칼럼을 포함하고 이 칼럼에 의해서 분산되어있다면, 하나의 store에 제한된 모든 쿼리들은 하나의 worker node에서 효율적으로 실행될수 있다. 더 자세한 설명은 <a href="http://docs.citusdata.com/en/v9.5/sharding/data_modeling.html#colocation">Table Co-Location</a>를 참고하자.</p><h3 id="parallelism">Parallelism</h3><p>쿼리들을 여러 머신에 분산시키는것은 더많은 쿼리가 실행되도록 허락하고 클러스터에 새로운 머신을 추가하여 processing speed를 증가시킬수 있도록 허락한다. 추가적으로 단일 쿼리를 여러 fragment로 쪼개는것은 processing power를 증가시킬수 있다. 이는 병렬성을 증가시키고, CPU core의 사용을 증가시킨다. 쿼리의 결과는 여전히 coordinator에게 전달되어야하기 때문에 마지막 결과가 compact할때(aggregate function의 경우) 더 명백히 speedup를 볼수있다.</p><p><a href="http://docs.citusdata.com/en/v9.5/develop/reference_processing.html#citus-query-processing">Query Processing</a>은 어떻게 쿼리들이 fragment로 나누어지는지 설명하고 있다.</p><h2 id="출처">출처</h2><p><a href="http://docs.citusdata.com/en/v9.5/get_started/concepts.html">Citus 공식문서</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/database/'>Database</a>, <a href='/categories/postgresql/'>PostgreSQL</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Citus - Study Log&url=https://jaegukim.github.io/posts/citus/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Citus - Study Log&u=https://jaegukim.github.io/posts/citus/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Citus - Study Log&url=https://jaegukim.github.io/posts/citus/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/software-engineering-at-google/">Software Engineering at Google</a><li><a href="/posts/til/">TIL</a><li><a href="/posts/custom-default-backend-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0/">custom error page 띄우기</a><li><a href="/posts/cors-setting/">CORS setting</a><li><a href="/posts/helm-chart/">Helm Chart</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/replicaidentity/"><div class="card-body"> <span class="timeago small" >Jan 6, 2021<i class="unloaded">2021-01-06T10:02:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Replica Identity</h3><div class="text-muted small"><p> Replica Identity 이 세팅에 따라서 업데이트 또는 삭제된 행들을 파악하는데 사용되는 WAL(write-ahead-log)에 기록되는 정보가 달라진다. logical replication이 사용중일때를 제외하고는 효력이 없다. 4가지 모드 DEFAULT non system table들...</p></div></div></a></div><div class="card"> <a href="/posts/logical-replication/"><div class="card-body"> <span class="timeago small" >Jan 6, 2021<i class="unloaded">2021-01-06T22:11:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Logical Replication</h3><div class="text-muted small"><p> Logical Replication replication identity(보통은 primary key) 에 기반하여, 데이터 오브젝트들과 그것들의 변화를 복제하는 방법을 말한다. 정확한 block 주소, byte-by-byte replication을 사용하는 physical replication과는 비교되는 개념이다. PostgreSQL은 physi...</p></div></div></a></div><div class="card"> <a href="/posts/command-mongo/"><div class="card-body"> <span class="timeago small" >Oct 5, 2021<i class="unloaded">2021-10-05T21:43:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>command(MongoDB)</h3><div class="text-muted small"><p> login with root user 1 2 3 $ mongo &gt;&gt; use admin &gt;&gt; db.auth("username", "password") Drop all databases except for internal collections 1 2 3 4 5 6 7 8 9 10 11 db .getMongo() .getDB...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/message-queue-%EC%82%AC%EC%9A%A9%EC%9D%B4%EC%9C%A0/" class="btn btn-outline-primary" prompt="Older"><p>Message Queue 사용이유</p></a> <a href="/posts/data-processing-architecture/" class="btn btn-outline-primary" prompt="Newer"><p>Data Processing Architecture</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//jaegukim.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Citus'; this.page.url = 'https://jaegukim.github.io/posts/citus/'; this.page.identifier = '/posts/citus/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Jaegoo.Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jaegukim.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
