<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Cache,Persist" /><meta name="author" content="Jaegoo Kim" /><meta property="og:locale" content="en" /><meta name="description" content="Spark DataFrame Cache, Persist" /><meta property="og:description" content="Spark DataFrame Cache, Persist" /><link rel="canonical" href="https://jaegukim.github.io/posts/cachepersist/" /><meta property="og:url" content="https://jaegukim.github.io/posts/cachepersist/" /><meta property="og:site_name" content="Study Log" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-02-23T13:19:00+08:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Cache,Persist" /><meta name="twitter:site" content="@JaeguKim" /><meta name="twitter:creator" content="@Jaegoo Kim" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Jaegoo Kim"},"dateModified":"2021-03-29T21:13:21+08:00","datePublished":"2021-02-23T13:19:00+08:00","description":"Spark DataFrame Cache, Persist","headline":"Cache,Persist","mainEntityOfPage":{"@type":"WebPage","@id":"https://jaegukim.github.io/posts/cachepersist/"},"url":"https://jaegukim.github.io/posts/cachepersist/"}</script><title>Cache,Persist | Study Log</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Study Log"><meta name="application-name" content="Study Log"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/22807942?s=460&u=cc1d822a8be2c87ac3aa4917adaadeca5487c515&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Study Log</a></div><div class="site-subtitle font-italic">“ In order to be irreplaceable, one must always be different” – Coco Chanel</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/JaeguKim" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/JaeguKim" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kimwithglasses','kakao.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Cache,Persist</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Cache,Persist</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Jaegoo.Kim </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Feb 23, 2021, 1:19 PM +0800" >Feb 23, 2021<i class="unloaded">2021-02-23T13:19:00+08:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Mar 29, 2021, 10:13 PM +0900" >Mar 29, 2021<i class="unloaded">2021-03-29T21:13:21+08:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1034 words">5 min read</span></div></div><div class="post-content"><h2 id="spark-dataframe-cache-persist">Spark DataFrame Cache, Persist</h2><p>Spark Cache,Persist는 잡의 퍼포먼스를 개선하기위해 반복적이고 상호작용이 많은 spark 어플리케이션에 대해서 DataFrame/Dataset을 최적화 하는 기술이다.</p><p><code class="language-plaintext highlighter-rouge">cache()</code> 와 <code class="language-plaintext highlighter-rouge">persist()</code> 함수를 사용하여, spark은 데이터 프레임 중간 결과를 저장하는 최적화 메커니즘을 제공하여, 연속적인 액션들이 재사용될수 있도록 한다.</p><p>데이터 셋을 persist할때, 각 노드는 partition된 데이터를 메모리에 저장하고 그 데이터셋에 대해서 다른 action연산을 할때 데이터를 재사용한다. 노드의 persist된 데이터는 fault-tolerant하다. 즉, 어느 한 데이터 셋 파티션이 손실되더라도, 자동으로 그것을 생성한 원래 transformation을 사용하여 다시 계산된다.</p><h3 id="dataframe-cachingpersistence의-이점">DataFrame Caching,Persistence의 이점</h3><ul><li>Cost efficient - spark 연산은 매우 비싼 작업이고 따라서 계산결과를 재사용하여 비용을 절감할수있다.<li>Time efficient - 반복되는 계산결과를 재사용하는것은 시간을 절약할수 있다.<li>Execution time - job의 실행시간이 절약되므로 더 많은 잡을 같은 클러스터에 실행할수 있다.</ul><h3 id="spark-cache-syntax-과-예시">Spark Cache Syntax 과 예시</h3><p><code class="language-plaintext highlighter-rouge">cache()</code> 함수는 DataFrame 또는 DataSet을 디폴트로 storage level이 <code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK</code> 로 저장한다.</p><p><code class="language-plaintext highlighter-rouge">cache() : Dataset.this.type</code></p><p>Spark <code class="language-plaintext highlighter-rouge">cache()</code> 함수는 내부적으로 <code class="language-plaintext highlighter-rouge">persist()</code> 를 호출하고 내부적으로 DataFrame 이나 Dataset의 결과를 캐시하기위해 <code class="language-plaintext highlighter-rouge">sparkSession.sharedState.cacheManager.cacheQuery</code> 를 사용한다.</p><p><strong>예시</strong></p><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre><span class="k">val</span> <span class="nv">spark</span><span class="k">:</span><span class="kt">SparkSession</span> <span class="o">=</span> <span class="nv">SparkSession</span><span class="o">.</span><span class="py">builder</span><span class="o">()</span>
    <span class="o">.</span><span class="py">master</span><span class="o">(</span><span class="s">"local[1]"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">appName</span><span class="o">(</span><span class="s">"SparkByExamples.com"</span><span class="o">)</span>
    <span class="o">.</span><span class="py">getOrCreate</span><span class="o">()</span>

  <span class="c1">//read csv with options</span>
  <span class="k">val</span> <span class="nv">df</span> <span class="k">=</span> <span class="nv">spark</span><span class="o">.</span><span class="py">read</span><span class="o">.</span><span class="py">options</span><span class="o">(</span><span class="nc">Map</span><span class="o">(</span><span class="s">"inferSchema"</span><span class="o">-&gt;</span><span class="s">"true"</span><span class="o">,</span><span class="s">"delimiter"</span><span class="o">-&gt;</span><span class="s">","</span><span class="o">,</span><span class="s">"header"</span><span class="o">-&gt;</span><span class="s">"true"</span><span class="o">))</span>
    <span class="o">.</span><span class="py">csv</span><span class="o">(</span><span class="s">"src/main/resources/zipcodes.csv"</span><span class="o">)</span>
  
  <span class="k">val</span> <span class="nv">df2</span> <span class="k">=</span> <span class="nv">df</span><span class="o">.</span><span class="py">where</span><span class="o">(</span><span class="nf">col</span><span class="o">(</span><span class="s">"State"</span><span class="o">)</span> <span class="o">===</span> <span class="s">"PR"</span><span class="o">).</span><span class="py">cache</span><span class="o">()</span>
  <span class="nv">df2</span><span class="o">.</span><span class="py">show</span><span class="o">(</span><span class="kc">false</span><span class="o">)</span>

  <span class="nf">println</span><span class="o">(</span><span class="nv">df2</span><span class="o">.</span><span class="py">count</span><span class="o">())</span>

  <span class="k">val</span> <span class="nv">df3</span> <span class="k">=</span> <span class="nv">df2</span><span class="o">.</span><span class="py">where</span><span class="o">(</span><span class="nf">col</span><span class="o">(</span><span class="s">"Zipcode"</span><span class="o">)</span> <span class="o">===</span> <span class="mi">704</span><span class="o">)</span>

  <span class="nf">println</span><span class="o">(</span><span class="nv">df2</span><span class="o">.</span><span class="py">count</span><span class="o">())</span>
</pre></table></code></div></div><h3 id="dataframe-persist-syntax와-예시">DataFrame Persist Syntax와 예시</h3><p>persist함수는 다음의 storage level을 설정가능하다. <code class="language-plaintext highlighter-rouge">MEMORY_ONLY</code>. <code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK</code>,<code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK_SER</code>, <code class="language-plaintext highlighter-rouge">DISK_ONLY</code>, <code class="language-plaintext highlighter-rouge">MEMORY_ONLY_2</code>, <code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK_2</code> 등</p><p><strong>문법</strong></p><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">persist</span><span class="o">()</span> <span class="k">:</span> <span class="kt">Dataset.this.type</span>
<span class="nf">persist</span><span class="o">(</span><span class="n">newLevel</span> <span class="k">:</span> <span class="kt">org.apache.spark.storage.StorageLevel</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Dataset.this.</span><span class="k">type</span><span class="o">)</span>
</pre></table></code></div></div><p>첫번째 시그니처는 디폴트로 <code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK</code>로 저장한다. 두번째는 storage level을 인자로 받는다.</p><p><strong>예시</strong></p><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="k">val</span> <span class="nv">dfPersist</span> <span class="k">=</span> <span class="nv">df</span><span class="o">.</span><span class="py">persist</span><span class="o">()</span>
<span class="k">val</span> <span class="nv">dfPersist</span> <span class="k">=</span> <span class="nv">df</span><span class="o">.</span><span class="py">persist</span><span class="o">(</span><span class="nv">StorageLevel</span><span class="o">.</span><span class="py">MEMORY_ONLY</span><span class="o">)</span>
</pre></table></code></div></div><h3 id="unpersist-syntax">Unpersist syntax</h3><p>Spark은 persist된 데이터가 사용되지 않으면 LRU 알고리즘에 따라서 자동으로 삭제한다. 수동으로 데이터를 삭제하는것도 가능하다. <code class="language-plaintext highlighter-rouge">unpersist()</code> 함수는 dataset에 대한 모든 블럭들을 메모리와 디스크에서 삭제한다.</p><p><strong>문법</strong></p><div lang="scala" class="language-scala highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nf">unpersist</span><span class="o">()</span> <span class="k">:</span> <span class="kt">Dataset.this.type</span>
<span class="nf">unpersist</span><span class="o">(</span><span class="n">blocking</span> <span class="k">:</span> <span class="kt">scala.Boolean</span><span class="o">)</span> <span class="k">:</span> <span class="kt">Dataset.this.type</span>
</pre></table></code></div></div><h3 id="spark-persist-storage-level">Spark Persist storage level</h3><ul><li><code class="language-plaintext highlighter-rouge">MEMORY_ONLY</code> - RDD <code class="language-plaintext highlighter-rouge">cache()</code> 함수의 기본값이고 RDD나 DataFrame을 역직열화 포맷으로 JVM에 저장. 메모리가 충분하지 않으면 몇몇 파티션은 저장이 안되고 필요할때 다시 계산된다. RDD의 경우와 달리 <code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK</code> 레벨보다는 느리다. 느린이유는 저장되지 않은 파티션들을 다시 계산하고 인메모리 칼럼 표현으로 계산하는 과정이 비싸기 때문이다. Spark은 메모리에 LRU eviction rule을 적용한다.<li><code class="language-plaintext highlighter-rouge">MEMORY_ONLY_SER</code> - <code class="language-plaintext highlighter-rouge">MEMORY_ONLY</code> 와 동일하지만 차이점은 RDD를 직렬화 포맷으로 저장한다는 차이가 있다. MEMORY_ONLY 보다는 더 적은 공간을 소모하지만 역직렬화를 하기 위해서 CPU cycle이 필요하다.<li><code class="language-plaintext highlighter-rouge">MEMORY_ONLY_2</code> - <code class="language-plaintext highlighter-rouge">MEMORY_ONLY</code> 와 동일하지만 각 파티션을 두개의 클러스터 노드로 복제한다.<li><code class="language-plaintext highlighter-rouge">MEMORY_ONLY_SER_2</code> - <code class="language-plaintext highlighter-rouge">MEMORY_ONLY_SER</code> 와 동일하지만 각 파티션을 두개의 클러스터 노드로 복제<li><code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK</code> - DataFrame or Dataset의 기본 행동이다. JVM상에 역직열화된 객체들이 저장된다. 요구 공간이 현재 이용가능한 공간을 초과하면, 일부 파티션들이 디스크로 저장되고 필요시 디스크에서 읽힌다. I/O 과정때문에 속도가 떨어질수있다. shuffle 과정에서 파일들이 생성될때 캐싱할 수 있기 때문에 주로 사용한다.<li><code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK_SER</code><li><code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK_2</code><li><code class="language-plaintext highlighter-rouge">MEMORY_AND_DISK_SER_2</code><li><code class="language-plaintext highlighter-rouge">DISK_ONLY</code><li><code class="language-plaintext highlighter-rouge">DISK_ONLY_2</code></ul><h2 id="출처">출처</h2><p><a href="https://sparkbyexamples.com/spark/spark-dataframe-cache-and-persist-explained/">https://sparkbyexamples.com/spark/spark-dataframe-cache-and-persist-explained/</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/dataengineering/'>DataEngineering</a>, <a href='/categories/spark/'>Spark</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Cache,Persist - Study Log&url=https://jaegukim.github.io/posts/cachepersist/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Cache,Persist - Study Log&u=https://jaegukim.github.io/posts/cachepersist/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Cache,Persist - Study Log&url=https://jaegukim.github.io/posts/cachepersist/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink('', 'Link copied successfully!')" data-toggle="tooltip" data-placement="top" title="Copy link"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/software-engineering-at-google/">Software Engineering at Google</a><li><a href="/posts/til/">TIL</a><li><a href="/posts/custom-default-backend-%EC%84%A4%EC%A0%95%ED%95%98%EA%B8%B0/">custom error page 띄우기</a><li><a href="/posts/cors-setting/">CORS setting</a><li><a href="/posts/helm-chart/">Helm Chart</a></ul></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/spark/"><div class="card-body"> <span class="timeago small" >Sep 24, 2020<i class="unloaded">2020-09-24T00:00:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Spark와 Data Engineering 관련 프로젝트 시작하기</h3><div class="text-muted small"><p> What Is Spark? Open-source distributed general-purpose cluster-computing framework. How to start data engineering projects? Choose any framework, let’s say Kafka. Write some codes using that ...</p></div></div></a></div><div class="card"> <a href="/posts/rdds-vs-dataframes-and-datasets/"><div class="card-body"> <span class="timeago small" >Feb 2, 2021<i class="unloaded">2021-02-02T17:39:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>RDDs vs DataFrames vs Datasets</h3><div class="text-muted small"><p> Resilient Distributed Dataset(RDD) RDD는 데이터의 immutable distributed collection, 클러스터의 노드들에 분할되어있고 병렬적으로 처리됨. 여러 분산 노드에 걸쳐서 저장되는 변경이 불가능한 데이터(객체)의 집합으로 각각의 RDD는 여러개의 파티션으로 분리가 됩니다. 즉, 스파크 내에 저장된 데이터...</p></div></div></a></div><div class="card"> <a href="/posts/%EC%A4%91%EC%B2%A9%EB%90%9C-schema-flattening%ED%95%98%EA%B8%B0/"><div class="card-body"> <span class="timeago small" >Feb 10, 2021<i class="unloaded">2021-02-10T08:56:00+08:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>중첩된 schema flattening하기</h3><div class="text-muted small"><p> def flattenSchema(schema: StructType, prefix: String = null): Array[Column] = { schema.fields.flatMap(f =&gt; { val colName = if (prefix == null) f.name else (prefix + "." + f.name) ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/spark-memory-architecture/" class="btn btn-outline-primary" prompt="Older"><p>Spark Memory Architecture</p></a> <a href="/posts/schema-evolution/" class="btn btn-outline-primary" prompt="Newer"><p>Schema Registry</p></a></div><div id="disqus" class="pt-2 pb-2"><p class="text-center text-muted small pb-5"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script src="/assets/js/lib/jquery.disqusloader.min.js"></script> <script> const options = { scriptUrl: '//jaegukim.disqus.com/embed.js', disqusConfig: function() { this.page.title = 'Cache,Persist'; this.page.url = 'https://jaegukim.github.io/posts/cachepersist/'; this.page.identifier = '/posts/cachepersist/'; } }; $.disqusLoader('#disqus', options); </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/username">Jaegoo.Kim</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://jaegukim.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
